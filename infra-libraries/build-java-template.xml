<project name="build-java-template" xmlns:ivy="antlib:org.apache.ivy.ant">
	<dirname property="build-java-template.basedir" file="${ant.file.build-java-template}" />
	<property name="infra-libraries.dir" value="${build-java-template.basedir}" />
	<property name="infra-libraries.ant.dir" value="${infra-libraries.dir}/ant" />
	<property name="infra-libraries.dep.dir" value="${infra-libraries.dir}/dep" />

	<property file="${infra-libraries.dir}/ivy-install.properties" />

	<property file="${basedir}/build.properties" />
	<property file="${infra-libraries.dir}/build-java-template.properties" />

	<fail message="Please build using Ant 1.8.0 or higher.">
		<condition>
			<not>
				<antversion atleast="1.8.0" />
			</not>
		</condition>
	</fail>

	<target name="default" depends="retrieve">
	</target>

	<target name="ivy-init">
		<path id="ivy.lib.path">
			<fileset dir="${ivy.install.jar.dir}" includes="*.jar" />
		</path>
		<taskdef resource="org/apache/ivy/ant/antlib.xml" uri="antlib:org.apache.ivy.ant" classpathref="ivy.lib.path" />
		<ivy:configure file="${infra-libraries.dir}/ivy-settings-retrieve.xml" settingsid="ivy.settings.retrieve" override="notallowed" />
		<ivy:configure file="${infra-libraries.dir}/ivy-settings-compile.xml" settingsid="ivy.settings.compile" override="notallowed" />
	</target>

	<target name="init">
		<mkdir dir="${build.dir}" />
		<mkdir dir="${build.artifacts.dir}" />
		<mkdir dir="${build.class.dir}" />
		<mkdir dir="${build.lib.dir}" />
	</target>

	<target name="clean">
		<delete dir="${build.artifacts.dir}" />
		<delete dir="${build.class.dir}" />
		<delete dir="${build.lib.dir}" />
		<delete dir="${build.dir}" />
	</target>

	<target name="retrieve" depends="ivy-init,init">
		<ivy:retrieve pattern="${build.lib.pattern}" conf="default,test" settingsref="ivy.settings.retrieve" />
	</target>

	<target name="compile" depends="retrieve">
		<!-- Get class path. -->
		<ivy:cachepath pathid="ivy.cachepath.compile" settingsRef="ivy.settings.compile" />
		<pathconvert pathsep="${line.separator}  " property="dependency.list.compile" refid="ivy.cachepath.compile" />
		<echo>DEPENDENCY LIST</echo>
		<echo>  ${dependency.list.compile}</echo>
		<ivy:report conf="default" settingsRef="ivy.settings.compile" todir="${build.dir}" />

		<!-- Copy resource files to classes directory. -->
		<copy todir="${build.class.dir}" preservelastmodified="true" overwrite="true">
			<fileset dir="${src.main.res}" />
		</copy>

		<!-- Compile source files to classes directory. -->
		<javac srcdir="${src.main.java.dir}" destdir="${build.class.dir}"
			debug="${compile.debug}" debuglevel="${compile.debuglevel}"
			encoding="${compile.encoding}"
			target="${compile.target}" source="${compile.source}"
			includeAntRuntime="false">
			<classpath>
				<pathelement id="ivy.cachepath.compile" />
			</classpath>
		</javac>
	</target>

	<target name="test-compile" depends="compile">

	</target>

</project>